---
title: Mysqlçš„å­—ç¬¦é›†é—®é¢˜
tags: Mysql
categories: Mysql
abbrlink: 53399
date: 2021-11-19 18:04:46
summary_img:
encrypt:
enc_pwd:
---

## ä¸€ é—®é¢˜èƒŒæ™¯

 æŠ¥é”™:

```
'\\xF0\\x9F\\x91\\xAC' for column 'counselor_user_name' at row 1","record":[{"byteSize":2,"index":0,"rawData":55,"type":"LONG"},{"byteSize":3,"index":1,"rawData":565,"type":"LONG"},{"byteSize":4,"index":2,"rawData":"ç¾ä¼ŠğŸ‘¬","type":"STRING"}
```

â€‹	è¡¨æƒ…ç¬¦å·ç­‰,å‘MySQLå¯¼æ•°æ®æŠ¥é”™,æ•°æ®åº“ç¼–ç æ ¼å¼ï¼Œè¡¨ç¼–ç æ ¼å¼å’Œå­—æ®µç¼–ç æ ¼å¼çš„æ—¶å€™ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºâ€œutf-8â€ï¼Œè¿™å¯¹äºæ±‰å­—æ¥è¯´è¶³å¤Ÿäº†ï¼Œåœ¨mysqlä¸­utf8å 3ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯å¯¹äºç§»åŠ¨ç«¯çš„ç‰¹æ®Šè¡¨æƒ…ç¬¦å·æ¥è¯´ï¼Œä¸‰ä¸ªå­—èŠ‚æ˜¯ä¸å¤Ÿçš„ï¼Œä»–éœ€è¦å››ä¸ªå­—èŠ‚ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä½¿ç”¨utf8å°±ä¼šå‡ºç°â€˜\xF0\x9F\x8F\x80â€™çš„é—®é¢˜ã€‚

## äºŒ è§£å†³

1. å¯ä»¥å¯¹4å­—èŠ‚çš„å­—ç¬¦è¿›è¡Œç¼–ç å­˜å‚¨ï¼Œç„¶åå–å‡ºæ¥çš„æ—¶å€™ï¼Œå†è¿›è¡Œè§£ç ã€‚ä½†æ˜¯è¿™æ ·åšä¼šä½¿å¾—ä»»ä½•ä½¿ç”¨è¯¥å­—ç¬¦çš„åœ°æ–¹éƒ½è¦è¿›è¡Œç¼–ç ä¸è§£ç ã€‚

2. **æ›´æ”¹æ•°æ®åº“çš„ç¼–ç ä¸ºutf8mb4:**utf8mb4ç¼–ç æ˜¯utf8ç¼–ç çš„è¶…é›†ï¼Œå…¼å®¹utf8ï¼Œå¹¶ä¸”èƒ½å­˜å‚¨4å­—èŠ‚çš„è¡¨æƒ…å­—ç¬¦ã€‚ 
   é‡‡ç”¨utf8mb4ç¼–ç çš„å¥½å¤„æ˜¯ï¼šå­˜å‚¨ä¸è·å–æ•°æ®çš„æ—¶å€™ï¼Œä¸ç”¨å†è€ƒè™‘è¡¨æƒ…å­—ç¬¦çš„ç¼–ç ä¸è§£ç é—®é¢˜ã€‚

   æ³¨æ„: éœ€è¦æ•°æ®åº“å’Œç›¸å…³è¡¨éƒ½ä¿®æ”¹ä¸ºutf8mb4

   ```mysql
   #æŸ¥çœ‹æ•°æ®åº“çš„å­—ç¬¦é›†:
   	show variables like '%character%';
   #æŸ¥çœ‹æ¯ä¸ªåº“çš„å­—ç¬¦é›†;
   	select schema_name,default_character_set_name from information_schema.schemata;
   ```

## ä¸‰ ä¿®æ”¹

```
ä¿®æ”¹mysqlçš„é…ç½®æ–‡ä»¶,my.cnf (windowsä¸ºmy.ini)
my.cnf ä¸€èˆ¬åœ¨etc/mysql/my.cnf
ä¿®æ”¹:
	[client]  
default-character-set=utf8mb4  
[mysqld]  
character-set-server = utf8mb4  
collation-server = utf8mb4_unicode_ci  
init_connect='SET NAMES utf8mb4'  
skip-character-set-client-handshake = true  
[mysql]  
default-character-set = utf8mb4
```

8ä¸ªé…ç½®æ–‡ä»¶

```mysql
character_set_client
	ä¸»è¦ç”¨æ¥è®¾ç½®å®¢æˆ·ç«¯ä½¿ç”¨çš„å­—ç¬¦é›†ã€‚
character_set_connection
	ä¸»è¦ç”¨æ¥è®¾ç½®è¿æ¥æ•°æ®åº“æ—¶çš„å­—ç¬¦é›†ï¼Œå¦‚æœç¨‹åºä¸­æ²¡æœ‰æŒ‡æ˜è¿æ¥æ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†ç±»å‹åˆ™æŒ‰ç…§è¿™ä¸ªå­—ç¬¦é›†è®¾ç½®ã€‚
character_set_database
	ä¸»è¦ç”¨æ¥è®¾ç½®é»˜è®¤åˆ›å»ºæ•°æ®åº“çš„ç¼–ç æ ¼å¼ï¼Œå¦‚æœåœ¨åˆ›å»ºæ•°æ®åº“æ—¶æ²¡æœ‰è®¾ç½®ç¼–ç æ ¼å¼ï¼Œå°±æŒ‰ç…§è¿™ä¸ªæ ¼å¼è®¾ç½®ã€‚
character_set_filesystem
	æ–‡ä»¶ç³»ç»Ÿçš„ç¼–ç æ ¼å¼ï¼ŒæŠŠæ“ä½œç³»ç»Ÿä¸Šçš„æ–‡ä»¶åè½¬åŒ–æˆæ­¤å­—ç¬¦é›†ï¼Œå³æŠŠ character_set_clientè½¬æ¢character_set_filesystemï¼Œ é»˜è®¤binaryæ˜¯ä¸åšä»»ä½•è½¬æ¢çš„ã€‚
character_set_results
	æ•°æ®åº“ç»™å®¢æˆ·ç«¯è¿”å›æ—¶ä½¿ç”¨çš„ç¼–ç æ ¼å¼ï¼Œå¦‚æœæ²¡æœ‰æŒ‡æ˜ï¼Œä½¿ç”¨æœåŠ¡å™¨é»˜è®¤çš„ç¼–ç æ ¼å¼ã€‚
character_set_server
	æœåŠ¡å™¨å®‰è£…æ—¶æŒ‡å®šçš„é»˜è®¤ç¼–ç æ ¼å¼ï¼Œè¿™ä¸ªå˜é‡å»ºè®®ç”±ç³»ç»Ÿè‡ªå·±ç®¡ç†ï¼Œä¸è¦äººä¸ºå®šä¹‰ã€‚
character_set_system
	æ•°æ®åº“ç³»ç»Ÿä½¿ç”¨çš„ç¼–ç æ ¼å¼ï¼Œè¿™ä¸ªå€¼ä¸€ç›´æ˜¯utf8ï¼Œä¸éœ€è¦è®¾ç½®ï¼Œå®ƒæ˜¯ä¸ºå­˜å‚¨ç³»ç»Ÿå…ƒæ•°æ®çš„ç¼–ç æ ¼å¼ã€‚
character_sets_dir
	è¿™ä¸ªå˜é‡æ˜¯å­—ç¬¦é›†å®‰è£…çš„ç›®å½•ã€‚
```

ä¿®æ”¹åé‡å¯æ•°æ®åº“:

```mysql
#é‡å¯
service mysql restart
#åœæ­¢
service mysql stop
#å¯åŠ¨
service mysql start
```

```mysql
ä¸€èˆ¬åªä¿®æ”¹:
	character_set_client
	character_set_connection
	character_set_database
	character_set_results
	character_set_server  ## å¿…æ”¹
è¿™ä¸‰ä¸ªä¸ç”¨åŠ¨:
	character_set_filesystem
	character_set_system
	character_sets_dir
```

**å€ŸåŠ©ç½‘ä¸Šçš„ä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·è¯·æ±‚çš„å­—ç¬¦é›†è½¬æ¢æµç¨‹æ¥æ›´å¥½çš„ç†è§£ä¸Šè¿°å‡ ä¸ªå˜é‡ï¼š**
mysql Serveræ”¶åˆ°è¯·æ±‚æ—¶å°†è¯·æ±‚æ•°æ®ä» character_set_client è½¬æ¢ä¸º character_set_connection
è¿›è¡Œå†…éƒ¨æ“ä½œå‰å°†è¯·æ±‚æ•°æ®ä» character_set_connection è½¬æ¢ä¸ºå†…éƒ¨æ“ä½œå­—ç¬¦é›†,æ­¥éª¤å¦‚ä¸‹
ã€€ã€€A. ä½¿ç”¨æ¯ä¸ªæ•°æ®å­—æ®µçš„ CHARACTER SET è®¾å®šå€¼ï¼›
ã€€ã€€B. è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨å¯¹åº”æ•°æ®è¡¨çš„å­—ç¬¦é›†è®¾å®šå€¼
ã€€ã€€C. è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨å¯¹åº”æ•°æ®åº“çš„å­—ç¬¦é›†è®¾å®šå€¼ï¼›
ã€€ã€€D. è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨ character_set_server è®¾å®šå€¼ã€‚
æœ€åå°†æ“ä½œç»“æœä»å†…éƒ¨æ“ä½œå­—ç¬¦é›†è½¬æ¢ä¸º character_set_results;

```
1 åœ¨å‘½ä»¤æç¤ºç¬¦çª—å£ä¸­è¾“å…¥MySQLå‘½ä»¤æˆ–sqlè¯­å¥ï¼Œå›è½¦åï¼Œè¿™äº›MySQLå‘½ä»¤æˆ–sqlè¯­å¥ç”±â€œå‘½ä»¤æç¤ºç¬¦çª—å£å­—ç¬¦é›†â€è½¬æ¢ä¸ºâ€œcharacter_set_clientâ€å®šä¹‰çš„å­—ç¬¦é›†

2ã€  ä½¿ç”¨å‘½ä»¤æç¤ºç¬¦çª—å£æˆåŠŸè¿æ¥MySQLæœåŠ¡å™¨åï¼Œå°±å»ºç«‹äº†ä¸€æ¡â€œæ•°æ®é€šä¿¡é“¾è·¯â€ï¼ŒMySQLå‘½ä»¤æˆ–sqlè¯­å¥æ²¿ç€â€œæ•°æ®é“¾è·¯â€ä¼ å‘MySQLæœåŠ¡å™¨ï¼Œç”±â€œcharacter_set_clientâ€å®šä¹‰çš„å­—ç¬¦é›†è½¬æ¢ä¸ºcharacter_set_connectionå®šä¹‰å­—ç¬¦é›†
3ã€  MySQLæœåŠ¡å®ä¾‹æ”¶åˆ°æ•°æ®é€šä¿¡é“¾è·¯ä¸­çš„MySQLå‘½ä»¤æˆ–sqlè¯­å¥ï¼Œå°†MySQLè¯­å¥æˆ–sqlè¯­å¥ä»character_set_connectionå®šä¹‰çš„å­—ç¬¦é›†è½¬æ¢ä¸ºcharacter_set_serverå®šä¹‰çš„å­—ç¬¦é›†

4ã€  è‹¥MySQLå‘½ä»¤æˆ–sqlè¯­å¥é’ˆå¯¹äºæŸä¸ªæ•°æ®åº“è¿›è¡Œæ“ä½œï¼Œæ­¤æ—¶å°†MySQLå‘½ä»¤æˆ–sqlå‘½ä»¤ä»character_set_serverå®šä¹‰çš„å­—ç¬¦é›†è½¬æ¢ä¸ºcharacter_set_databaseå®šä¹‰çš„å­—ç¬¦é›†

5ã€  MySQLå‘½ä»¤æˆ–sqlè¯­å¥æ‰§è¡Œç»“æŸåï¼Œå°†æ‰§è¡Œç»“æœè®¾ç½®ä¸ºcharacter_set_resultså®šä¹‰å­—ç¬¦é›†

6ã€  æ‰§è¡Œç»“æœæ²¿ç€æ‰“å¼€çš„æ•°æ®é€šä¿¡é“¾è·¯åŸè·¯è¿”å›ï¼Œå°†æ‰§è¡Œç»“æœåˆcharacter_set_resultså®šä¹‰çš„å­—ç¬¦é›†è½¬character_set_clientå®šä¹‰çš„å­—ç¬¦é›†ï¼Œæœ€ç»ˆè½¬æ¢ä¸ºå‘½ä»¤æç¤ºç¬¦çª—å£å­—ç¬¦é›†æ˜¾ç¤ºåˆ°å‘½ä»¤æç¤ºç¬¦çª—å£ä¸­ã€‚
```



